"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function editImage(conf) {
    preload(() => {
        window.ImgPen.editImage(conf.urlImage, conf.urlUploader, conf.urlFiles, conf.dirDestination, conf.onSave);
    });
}
exports.editImage = editImage;
function preload(onLoaded) {
    includeJS('//cdn.imgpen.com/imgpen.js', () => {
        window.ImgPen.load(() => {
            if (onLoaded)
                onLoaded();
        });
    });
}
exports.preload = preload;
function includeJS(url, onLoaded) {
    var scripts = document.getElementsByTagName("script");
    var alreadyExists = false;
    for (var i = 0; i < scripts.length; i++) {
        var src = scripts[i].getAttribute("src");
        if (src != null && src.indexOf(url) !== -1)
            alreadyExists = true;
    }
    if (!alreadyExists) {
        var script = document.createElement("script");
        script.type = "text/javascript";
        if (onLoaded) {
            if (script.readyState) {
                script.onreadystatechange = function () {
                    if (script.readyState === "loaded" || script.readyState === "complete") {
                        script.onreadystatechange = null;
                        onLoaded();
                    }
                };
            }
            else {
                script.onload = function () {
                    onLoaded();
                };
            }
        }
        script.src = url;
        document.getElementsByTagName("head")[0].appendChild(script);
    }
    else {
        if (onLoaded)
            onLoaded();
    }
}
